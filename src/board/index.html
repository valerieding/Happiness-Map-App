<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="../styles/bootstrap4.min.css">
    <link href="../styles/main.css" rel="stylesheet">
    <script type="application/javascript" src="../lib/jquery-3.2.1.min.js"></script>
    <script type="application/javascript" src="../lib/popper.min.js"></script>
    <script type="application/javascript" src="../lib/bootstrap4.min.js"></script>
    <title>Message Board</title>
  </head>
  <body>
    <script>
      $(function(){
        $("#myNav").load("../nav.html");
        // $.ajax({
        //  url: 'request/add_vote',
        //  type: 'post',
        //  dataType: 'json',
        //  data: {'latitude': 10, 'longitude': 10, 'happiness_level': 2}
        // });
        // $.ajax({
        //  url: 'request/add_post',
        //  type: 'post',
        //  dataType: 'json',
        //  data: {'latitude': 10, 'longitude': 10, 'message': 'another post'}
        // });
        // $.ajax({
        //  url: 'request/add_post',
        //  type: 'post',
        //  dataType: 'json',
        //  data: {'latitude': 10, 'longitude': 10, 'message': 'feeling 2/5'}
        // });
        // $.ajax({
        //  url: 'request/add_vote',
        //  type: 'post',
        //  dataType: 'json',
        //  data: {'latitude': 10, 'longitude': 10, 'happiness_level': 1}
        // });
        // $.ajax({
        //  url: 'request/add_post',
        //  type: 'post',
        //  dataType: 'json',
        //  data: {'latitude': 10, 'longitude': 10, 'message': 'just voted again 1/5 very sad!!!'}
        // });
        // $.ajax({
        //  url: 'request/add_post',
        //  type: 'post',
        //  dataType: 'json',
        //  data: {'latitude': 10, 'longitude': 10, 'message': 'feeling 1/5'}
        // });
      });
    </script>
    <script type="text/javascript">
    $(document).ready(function(){
        var messageArray = "";
        console.log("messageArray 1is: " + messageArray);
        $(function() {
            $.ajax({
               url: 'request/get_recent_posts',
               type: 'post',
               dataType: 'json',
               data: {'latitude': 10, 'longitude': 10},
               async: false,
               success: function(data) {
                  messageArray = data;
               }
              });
            $.each(messageArray, function(index, value){
              $("#posts").append(value['message'] + '<br>');
              $("#votes").append(value['happiness_level'] + '/5' + '<br>');
            });
          });
    });
    </script>
    <script>
      $(function() {
        $("#myform").submit(function(e) {
          e.preventDefault();
          $.ajax({
              url: 'request/add_post',
              type: 'post',
              dataType: 'json',
              data: {'latitude': 10, 'longitude': 10, 'message': $("#myform").serialize().slice(8)},
              success: function(data) {
                 console.log("added post successfully");
                 console.log("my form input: " + $("#myform").serialize().slice(8).replace(' ','%20'));
              }
          });

        });

    });
    </script>
    <div class="homepage">
      <div class="cover-container d-flex h-100 p-3 mx-auto flex-column">
        <div id="myNav"></div>
        <main role="main" class="inner cover text-center" id="home-cover">
          <h1 class="cover-heading">Message Board</h1>
        </main>
        <button type="button" class="btn btn-primary w-25 p-3 m-0">Make New Post</button>
        <form id="myform" method="post" action="">
          <input type="text" size="50" value="" name="message">
        </form>
        <div class="card w-50 p-3 mt-3" style="overflow-y: scroll">
          <img class="card-img-top" alt="">
          <div class="card-body">
            <div class="d-flex justify-content-between">
              <h5 class="card-title">Post</h5>
              <h5 class="card-title">Happiness Level</h5>
            </div>
           <div class="d-flex justify-content-between">
              <div id="posts"></div>
              <div id="votes"></div>
            </div>
            </div>
          </div>
        </div>
      </div>
    </div>


  </body>
</html>






















